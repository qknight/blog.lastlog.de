<!DOCTYPE html>
<!-- this document is auto-generated from pankat document editor -->
<html xmlns="http://www.w3.org/1999/xhtml">

<head data-article-dst-filename="qabstractitemmodel_vs_qstandarditemmodel.html">

<meta charset="utf-8" />
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>qabstractitemmodel vs qstandarditemmodel</title>

<script src="js/jquery.min.js"></script>

<script src="js/jquery-ui-1.9.1.custom.min.js"></script>
<script src="js/jquery.tocify.min.js"></script>

<link type="text/css" rel="stylesheet" href="css/jquery.tocify.css" />



<script src="js/reconnecting-websocket.min.js"></script>
<script src="js/pankat-websocket.js"></script>
<script src="js/diffDOM.js"></script>


<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />
<script src="js/bootstrap.min.js"></script>

<script src="js/anchor.min.js"></script>

<link rel="icon" href="media/favicon.ico" type="image/x-icon" />


<!--[if lt IE 9]>
  <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="css/pandoc-kate.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />

</head>
<body>

<div id="toc"></div>

<!-- menu begins -->
<div class="container">
  <nav class="navbar navbar-default">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">lastlog.de/blog</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="timeline.html"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> timeline</a></li>
        <li><a href="about.html"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> about</a></li>
        <li><a href="/draft" id="draft" style="display: none"><span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> draft</a></li>
        <li><a href="/draft?article=posts/roadmap.mdwn" id="roadmap" style="display: none"><span class="glyphicon glyphicon glyphicon-road" aria-hidden="true"></span> roadmap</a></li>

      </ul>

      <ul class="nav navbar-nav navbar-right">
        <li><a title="live updates of article updates on posts/qabstractitemmodel_vs_qstandarditemmodel.mdwn" id="websocket" style="display: none"><span id="websocketStatus" class="glyphicon glyphicon-remove" aria-hidden="true"></span> websocket</a></li>
        <!-- <li><a href="#">Login</a></li> -->
      </ul>

      <!--<div id="right">
        <form class="navbar-form navbar-right">
          <div class="form-group">
            <input type="text" class="form-control" placeholder="Search">
          </div>
        </form>
      </div>-->
    </div><!-- /.navbar-collapse -->
  </nav>

<div id="headerAndArticle">


  <div id="headerContainer">
    <header class="header"><span id="articleNavLeft"> <a href="gentoo_user_only_2gb_ram_or_less.html"> 
      <span class="glyphiconLink glyphicon glyphicon-chevron-left" aria-hidden="true" title="previous article"> </span> prev. article
    </a> </span><span id="articleNavRight"><a href="no_more_crashes_after_resuming_from_pm_suspend_iii.html"> 
        next article <span class="glyphiconLink glyphicon glyphicon-chevron-right" aria-hidden="true" title="next article"></span>
    </a> </span></header>
  </div>
  

  <div class="article">
    <h1 id="SiteTitle">qabstractitemmodel vs qstandarditemmodel</h1>
    <div id="date"><p><span id="lastupdated">20 sep 2010</span></p></div><div id="tags"><p><a href="timeline.html?filter=tag::qt" class="tagbtn btn btn-primary">qt</a><a href="timeline.html?filter=tag::usability" class="tagbtn btn btn-primary">usability</a><a href="timeline.html?filter=tag::visualization" class="tagbtn btn btn-primary">visualization</a><a href="timeline.html?filter=tag::QAbstractItemModel" class="tagbtn btn btn-primary">QAbstractItemModel</a></p></div>
    <h2 data-number="1" id="motivation">motivation</h2>
<p>lately i started working on a torrent implementation for the evopedia
project [1]. that will include the qt torrent example [2] but this
posting won’t be about any torrent related stuff.</p>
<p>first i thought about implementing a QAbstractItemModel but reading
various examples i discovered the QStandardItemModel.</p>
<h2 data-number="2" id="what-i-want-to-do">what i want to do</h2>
<p><a href="media/screenshot-20100920-223057.png"><img src=media/screenshot-20100920-223057.png size=450x alt="" style="float: right"></a></p>
<p>i have an item, represented via a Model and visualized by a a
QTreeView. the model basically hosts the item(s) and several views could
display that item(s) in different layouts but using exactly the same
data.</p>
<p>when a user clicks an item a torrent client will start downloading
it. the torrent client will update the state of the download by using
the item’s textfield via the model.</p>
<p>this can be implemented either by using a QAbstractItemModel or a
QStandardItemModel, so let’s see which one is easier to be used:</p>
<h2 data-number="3" id="discussion-qabstractitemmodel">discussion:
QAbstractItemModel</h2>
<p>i’ve been using this model quite some times now and i really love it
but it has one big limitation: every time you want to change an item
(which is an item of the model) you have to use the model to do that.
that means if an item want’s to change itself, you have to query the
representative QModelIndex and then use this with the model:</p>
<pre><code>// query the first row and column and a top level item, by using a invalid QModelIndex
QModelIndex* m = index(0,0,QModelIndex()); 
// here we set the data
m-&gt;setData(...); </code></pre>
<p>QModelIndex’es are used by views to access the data by using the
model interface. this is all about MVC and abstraction.</p>
<p>CONCEPT: most of the time there is no need for items to be able to
change themselves BUT in this case it is a very handy thing.</p>
<p>two ways of implementing this:</p>
<ul>
<li>either the item holds the torrent client object as well but the
torrent client object will update the text of the item using the
model</li>
<li>or one could also have a Model and a list of torrent clients and
then the torrent client accesses the item also via the QModelIndex but
this would mean having another lists to take care of</li>
</ul>
<p>i think either case is error prone, so let’s see how this could be
done using a QStandardItemModel instead:</p>
<h2 data-number="4" id="discussion-qstandarditemmodel">discussion:
QStandardItemModel</h2>
<p>in contrast using this model you don’t use QModelIndex’es at all.
instead you use an abstraction: the QStandardItem. the fun part about a
QStandardItem is that it is holding data which is accessed by all views
BUT it can also be used to change itself.</p>
<p>this code has been taken from the Qt QStandardItemModel manual (but
slightly extended):</p>
<pre><code>QStandardItemModel model;
QStandardItem *parentItem = model.invisibleRootItem();
for (int i = 0; i &lt; 4; ++i) {
  QStandardItem *item = new QStandardItem(QString(&quot;item %0&quot;).arg(i));
  parentItem-&gt;appendRow(item);
  parentItem = item;
  item-&gt;setText(&quot;foobar&quot;);
}</code></pre>
<p>therefore it is very easy to extend a QStandardItem by inheriting
from it. let’s call this new item a QExtendedStandardItem. within that
class one can have a torrent client object which does all the work. if
the state of the download changes from download started to download
finished, the torrent client can simply use setText(“finished”);</p>
<p>another point worth mentioning is that the torrent object could also
expand the QStandardItems with additional childs which could be used to
list up/down rates as well as peers/seeders and other valuable
parameters (can be seen in the above image).</p>
<h2 data-number="5" id="summary">summary</h2>
<p>using a QStandardItem makes it very easy to implement the torrent
client.</p>
<h2 data-number="6" id="links">links</h2>
<ul>
<li>[1] <a href="http://evopedia.info/"
class="uri">http://evopedia.info/</a></li>
<li>[2] <a href="http://doc.qt.nokia.com/4.6/network-torrent.html"
class="uri">http://doc.qt.nokia.com/4.6/network-torrent.html</a></li>
</ul>

  </div>

</div>

<div id="ArticleSourceCode">

<a href="posts/qabstractitemmodel_vs_qstandarditemmodel.mdwn" title="posts\qabstractitemmodel_vs_qstandarditemmodel.mdwn">article source</a>
</div>

</div>

<div id="scrollUp">
<span id="scrollUpBtn" class="glyphiconLink glyphicon glyphicon-chevron-up" aria-hidden="true" title="scroll up"></span>
</div>

<script>
$("#scrollUpBtn").click(function() {
  $("html, body").animate({ scrollTop: 0 }, "slow");
  return false;
});
</script>


<script>
window.onload = function(e){
  anchors.add('h1')
  anchors.add('h2')
  anchors.add('h3')
  anchors.add('h4')
  anchors.add('h5')
}
</script>




<script>
$(document).ready(function() {
  //Calls the tocify method on your HTML div.
  $("#toc").tocify();
});
$("#toc").hover(function() {
  $("#toc").css("z-index", "111")
}, function() {
  $("#toc").css("z-index", "1")
});
</script>



<script>

var shifted = false;

$(window).keyup(function(event) {
    shifted = event.shiftKey;
});

$(window).keydown(function(event) {
  if(event.keyCode == 16){
    shifted = event.shiftKey;
  }
  if (shifted == false) {
      if(event.keyCode == 37){
        $('.glyphicon-chevron-left')[0].click()
      }
      if(event.keyCode == 39){
        $('.glyphicon-chevron-right')[0].click()
      }
  }
});
</script>


<script>
// check if we got served from pankat-server
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if (xhr.readyState == XMLHttpRequest.DONE) {
  if (xhr.status == 200) {
    console.log("request to /pankat-server returned status: " + xhr.status + ", so yes we got served from pankat-server");
    $('#draft').css("display", "block");
    $('#roadmap').css("display", "block");
  }
}
}
xhr.open('GET', "/pankat-server", false);
xhr.send(null);
</script>
</body>
</html>
